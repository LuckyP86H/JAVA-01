# Redis主从复制

Redis的主从结构可以采用一主多从或者级联结构。

Redis主从复制可以根据是否是全量分为全量同步和增量同步。

**全量同步**
Redis全量复制一般发生在Slave从节点的初始化阶段，这时Slave需要将Master上的所有数据都复制一份。

具体步骤如下： 
\- Slave连接master，发送SYNC命令； 
\- master接收到SYNC命令后，开始执行BGSAVE命令生成RDB文件并使用缓冲区记录此后执行的所有写命令； 
\- master BGSAVE执行完后，向所有从服务器发送快照文件，并在发送期间继续记录被执行的写命令； 
\- Slave收到快照文件后丢弃所有旧数据，载入收到的快照； 
\- master快照发送完毕后开始向Slave发送缓冲区中的写命令； 
\- Slave完成对快照的载入，开始接收命令请求，并执行来自master缓冲区的写命令；