# RPC

## 背景

从单机到分布式，产生了很多的分布式通信协议和方式，**分布式通信最基本的是二进制的数据传输**。

## 定义

> RPC（Remote Procedure Call）远程过程（方法）调用，这只是一个统称和概念，具体实现有很多种。
>
> RPC就是要像调用本地的函数一样去调用远程函数。重点在于方法的调用（不支持对象的概念），多用于服务器集群之间的通信，因此常使用更加高效、短小精悍的传输模式以提高效率。

## 远程过程调用带来的新问题

在进行远程调用的时候，我们需要执行的函数体是在远程的机器上的，也就是说，方法是在另一个进程中执行的，这就带来了几个新问题：

1、Call ID映射。在RPC中，所有的函数都必须有自己的一个ID，找个ID在所有的进程中都是唯一的。客户端在做远程调用中，必须附上找个ID。

2、序列化和反序列化。需要客户端把参数先转换成一个字节流，传给服务端以后，再把字节流转成自己能够读取的格式。找个过程叫做序列化和反序列化。同理，从服务端返回的值也需要序列化和反序列化的过程。

3、网络传输。大部分的RPC框架都使用了TCP协议。

https://www.zhihu.com/question/25536695/answer/221638079

## 动态代理



> ### Socket
>
> Socket（套接字），用来描述IP地址和端口，是通信链的**句柄**。
>
> > 句柄的英文是 handle。在英文中，有操作、处理、控制之类的意义。作为一个名词时，是指某个中间媒介，通过这个中间媒介可控制、操作某样东西。这样说有点抽象，举个例子。door handle 是指门把手，通过门把手可以去控制门，但 door handle 并非 door 本身，只是一个中间媒介。又比如 knife handle 是刀柄，通过刀柄可以使用刀。跟 door handle 类似，我们可以用 file handle 去操作 file, 但 file handle 并非 file 本身。这个 file handle 就被翻译成文件句柄，同理还有各种资源句柄。
> > 链接：https://www.zhihu.com/question/27656256/answer/943130123
>
> 应用程序可以通过Socket向网络发送请求或者应答网络请求。
>
> Socket是支持TCP/IP协议的网络通信基本操作单位，是对网络通信过程中端点的抽象表示，包含了需要进行网络的通信所必须的5种信息：
>
> 1、连接所用的协议；
>
> 2、本地主机的IP地址；
>
> 3、本地远程的协议端口；
>
> 4、远地主机的IP地址；
>
> 5、远地进程的协议端口；

## TCP/IP 、HTTP、Socket的区别

网络由下往上分：

物理层、数据链路层、网络层（IP）、传输层(TCP)、会话层、表示层和应用层(HTTP)。

1. **TCP/IP协议是传输层协议，解决了数据如何在网络中传输；**
2. Socket是对TCP/IP协议的封装和应用；
3. HTTP是应用协议层的协议，主要解决如何包装数据。

我们在传输数据的时候，可以只是用传输层的TCP/IP协议，但是那样的话，如果没有应用层，便无法识别数据的内容，如果想要使传输的数据有意义，则必须使用到应用层协议。

应用层协议有很多，比如HTTP、FTP、TELNET等，也可以使用自己定义的应用层协议。web使用HTTP协议作为应用层协议，比如封装HTTP文本信息，然后使用TCP/IP作为传输协议将其发到网上。

我们平时所说的Socket，是对TCP/IP协议的封装，socket本身不是协议，而是一个调用接口，通过Socket，我们才能使用TCP/IP协议。socket编程接口在设计的时候，就希望也能适应其他的网络协议。所以，socket的出现只是使得程序员更加方便的使用TCP/IP协议儿宜，是对TCP/IP协议的抽象，从而形成了我们所知道的一些最基本的函数接口。

TCP/IP只是一个协议栈。就像操作系统的运行机制一样，必须要有具体的实现，同事还要提供堆外的操作接口。找个就像操作系统会提供标准的编程接口。**TCP/IP也要提供可供程序员做网络开发的所用的接口，这就是Socket编程接口。**

HTTP是小轿车，提供了封装或者显示数据的具体形式；Socket是发动机，提供了网络通信的能力。传输层的TCP是基于网络层的IP协议的，二应用层的HTTP协议又是基于传输层的TCP协议的，而socket本身不算是协议，只是提供了hi个针对TCP或者UDP编程的接口。

https://blog.csdn.net/Pk_zsq/article/details/6087367

